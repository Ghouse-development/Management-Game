# MGルール確認メモ

## 1. リスクカード修正（完了）

`applyRiskCard`と`applyRiskCardToAI`関数のcase文を`riskCards`配列のIDに合わせて修正済み。

### 主な修正内容
| ID | カード名 | 修正内容 |
|----|---------|---------|
| 1-2 | クレーム発生 | 追加（本社経費▲5） |
| 5-6 | 消費者運動発生 | 追加 |
| 7-8 | 得意先倒産 | 臨時収入/支出→正しい処理に修正 |
| 9-11 | 研究開発失敗 | 追加（青チップ返却） |
| 12-14 | 広告成功 | 追加 |
| 17-18 | 広告政策失敗 | 長期労務紛争→正しい処理に修正 |
| 24-25 | コンピュータートラブル | 盗難発生→正しい処理に修正 |
| 31-32 | 倉庫火災 | case 11→正しいIDに修正 |
| 43-44 | ストライキ発生 | 追加（1回休み） |
| 45-46 | 盗難発見 | case 24-25→正しいIDに修正 |
| 47-48 | 長期労務紛争 | 正しいIDに修正 |
| 49-50 | 設計トラブル発生 | 情報漏洩→正しい処理に修正 |

---

## 2. 教育チップの上限

- **2期**: 2枚まで
- **3期以降**: シニアルール（詳細は後日確認）

---

## 3. 保険の仕組み

### 保険金額
| 災害 | 保険金 |
|------|--------|
| 倉庫火災 | 材料1個あたり ¥8 |
| 盗難発見 | 製品1個あたり ¥10 |

### 保険チップ
- 保険使用後、チップは消費される
- 再加入の選択が可能（¥5）
- **TODO**: 再加入の選択UIを実装する

---

## 4. 行数管理

### 各期の行数上限
| 期 | 行数 |
|----|------|
| 2期 | 20行 |
| 3期 | 30行 |
| 4期 | 34行 |
| 5期 | 35行 |

### ルール
- 期首処理で1行消費（全社共通）
- 借入する場合はさらに1行消費
- 2期は借入不可
- **各社が個別に行数を消費**
- 誰か1社でも上限に達したら全社の期が終了
- **各社が個別に残り5行に達したら警告**（全社共通の1回警告ではない）

### 例：3期で借入する場合
- 30行 - 1行（期首処理） - 1行（借入） = 28行が実際のプレイ可能行数

---

## 5. 短期借入（要修正）

### 仕組み
| タイミング | 内容 | 例（¥100借入） |
|-----------|------|---------------|
| 借入時 | 金利20%即時払い | ¥20払い → 手取り¥80 |
| 1期末 | 元本の20%以上返済 | ¥20払い → 残元本¥80 |
| 2期首 | 残元本の20%金利 | ¥16払い |
| 2期末 | 元本の20%以上返済 | ¥16払い → 残元本¥64 |
| ... | 完済まで繰り返し | 全額返済も可能 |

### 修正が必要なコード
```javascript
// 現在（間違い）
company.cash += needed * 0.6;  // ¥60

// 正しい
company.cash += needed * 0.8;  // ¥80
```

### TODO
- [ ] 借入時の手取りを80%に修正
- [ ] 期首の金利支払い処理を実装
- [ ] 期末の返済処理を実装（20%以上、全額返済も可能）

---

## 6. 長期借入

### 仕組み
| 項目 | 短期借入 | 長期借入 |
|------|---------|---------|
| 金利 | 20% | 10% |
| 返済 | 20%以上 | 10%以上 |
| 手取り（¥100） | ¥80 | ¥90 |

- 短期借入と同じルール（期首に金利、期末に返済）
- 利率が異なるだけ

---

## 7. 未確認事項

- [ ] シニアルール（3期以降）の詳細
- [ ] VQ計算の正確な方法
- [ ] 期末処理の詳細
- [ ] その他ルールブックで確認が必要な項目

---

*最終更新: 2025-12-28*
