# 開発記録 2026-01-01

## 実装内容

### 1. 戦略タイプ別・行別アクションプラン（STRATEGY_ROW_PLANS）

全5戦略タイプ×4期間（2-5期）の詳細な行別アクションプランを実装。

#### 戦略タイプ別の特徴

| 戦略 | 特徴 | 2期初手 | 3期投資 | 差別化ポイント |
|------|------|---------|---------|---------------|
| **aggressive** | 高速サイクル | 広告→即販売 | セールス採用 | 販売回数最大化 |
| **tech_focused** | 研究最大化 | 研究×3枚 | アタッチ+次期研究 | 高価格市場狙い |
| **conservative** | 安定重視 | 教育→研究 | 6行目でアタッチ | リスク回避 |
| **price_focused** | 入札勝利 | 研究×2→販売 | 次期研究×2 | 価格競争力+4以上 |
| **balanced** | 標準 | 研究×2+教育 | アタッチ+ワーカー | バランス投資 |
| **unpredictable** | ランダム | 動的決定 | 動的決定 | 予測不能 |

#### 各期の行数

- 2期: 20行（全戦略で定義済み）
- 3期: 30行（全戦略で定義済み）
- 4期: 34行（全戦略で定義済み）
- 5期: 35行（全戦略で定義済み）

合計: 5戦略 × 4期 × 約30行 = **約600アクション定義**

### 2. getRowPlanAction関数の戦略別対応

```javascript
function getRowPlanAction(company, period) {
    const strategy = company.strategy || 'balanced';

    // 1. 戦略別プランを確認
    if (STRATEGY_ROW_PLANS[strategy] && STRATEGY_ROW_PLANS[strategy][period]) {
        rowPlan = STRATEGY_ROW_PLANS[strategy][period];
    }
    // 2. unpredictableはプラン無し（動的決定）
    else if (strategy === 'unpredictable') {
        return null;
    }
    // 3. balanced または未定義はデフォルトプラン
    else {
        rowPlan = PERIOD_STRATEGY_TARGETS[period].rowPlan;
    }
    // ...
}
```

### 3. 新規アクションタイプの追加

getRowPlanActionとexecuteGMaximizingActionに以下を追加:

- `BUY_ATTACHMENT`: アタッチメント購入（30円）
- `BUY_SMALL_MACHINE`: 小型機械購入（60円）
- `BUY_LARGE_MACHINE`: 大型機械購入（120円）
- `HIRE_WORKER`: ワーカー採用（5円）
- `HIRE_SALESMAN`: セールス採用（5円）
- `BUY_NEXT_CHIP`: 次期繰越チップ予約（20円）

### 4. G目標達成のための累積計画

```javascript
const CUMULATIVE_G_TARGETS = {
    2: { periodG: -20, cumulativeG: -20, equityTarget: 263 },  // 投資期
    3: { periodG: 40, cumulativeG: 20, equityTarget: 302 },
    4: { periodG: 100, cumulativeG: 120, equityTarget: 352 },
    5: { periodG: 200, cumulativeG: 320, equityTarget: 452 }   // 目標達成
};
```

### 5. 正確なF計算

各期のfBreakdownを定義:
- salary: 給与（期別単価×人数）
- depreciation: 減価償却
- pc: PCチップ
- insurance: 保険チップ
- chips: 研究・教育・広告チップ
- interest: 借入金利

## コミット履歴

1. `4c3b725` - AI戦略強化: 全5戦略タイプ×4期間の行別アクションプラン実装
2. `4e73aeb` - AI戦略強化: 行別アクションプラン実装とG最大化最適化
3. `a956f9a` - Feature: AI戦略強化（長期借入活用・進捗追跡・動的調整）
4. `3edaefb` - Fix: 税率50%に基づく正確なG目標計算
5. `3f2b997` - AI戦略修正: 2期初手を戦略別に多様化

## 動作フロー

```
executeAIStrategyByType
    ↓
getRowPlanAction(company, period)
    ↓
STRATEGY_ROW_PLANS[strategy][period] から該当行のアクション取得
    ↓
executeGMaximizingAction で実行
    ↓
失敗時は動的判断へフォールバック
```

## 次のステップ

1. 実際のゲームプレイでの動作確認
2. 各戦略のG達成率を検証
3. 必要に応じて行別プランの微調整
