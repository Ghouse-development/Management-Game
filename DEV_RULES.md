# MG (Management Game) 開発ルール・仕様書

## 行消費ルール（重要）
- **行を消費する**: お金の動きがある行動のみ
  - 材料仕入れ、完成投入（加工費¥1）、販売
  - チップ購入、採用、退職
  - 倉庫購入、機械購入、借入
- **行を消費しない**: パス（何もしない）のみ

## ターン構造
- 1ターン = 1行動（AI・プレイヤー共通）
- 倉庫購入などはカードを引く前にいつでも可能

## 市場ルール
| 市場 | 仕入値 | 販売値 | 容量 | 入札 |
|------|--------|--------|------|------|
| 仙台 | ¥10 | ¥40 | 3 | 必要 |
| 札幌 | ¥11 | ¥36 | 4 | 必要 |
| 福岡 | ¥12 | ¥32 | 6 | 必要 |
| 名古屋 | ¥13 | ¥28 | 9 | 必要 |
| 大阪 | ¥14 | ¥24 | 13 | 必要 |
| 東京 | ¥15 | ¥20 | 20 | 不要 |
| 海外 | ¥16 | ¥16 | ∞ | 不要 |

## 入札ルール
- **コール価格** = 表示価格 − (研究チップ × 2) − (親ボーナス 2)
- **勝者**: コール価格が最も低い人
- **受取額**: 表示価格（コール価格ではない）
- **親**: 入札を開始した人（−2のボーナス）

## 販売戦略
- **基本**: 高い価格を狙う
- **大量販売時**: 名古屋・大阪など容量の大きい市場も狙う
- **最悪**: 販売できないこと（機会損失）

## 借入ルール
### 長期借入
- **タイミング**: 3期以降の期首のみ
- **控除**: 借入時10%（¥100借入→¥90入金）
- **上限**:
  - 3期: 自己資本の0.5倍
  - 4期以降（自己資本300超）: 自己資本の1.0倍
- **返済**: 期末に最低10%必須

### 短期借入
- **タイミング**: 現金不足時に自動発生
- **控除**: 借入時20%（¥100借入→¥80入金）
- **返済**: 期末に最低20%必須

## AI基本戦略
- **安く仕入れて高く多く売る**
- 仕入→生産→販売のサイクルを回す
- 入札市場では`startAIBidding()`を使用

## 3期以降のサイコロ
- 前期PQトップがサイコロを振る
- 1-3: 仙台閉鎖、人件費×1.1
- 4-6: 仙台・札幌閉鎖、人件費×1.2
- 大阪上限価格 = 20 + サイコロの目

## AI販売ロジック（executeDefaultSale）
- 高価格市場を優先的に選択
- 大量販売時（5個以上）は市場容量も考慮
- スコア計算: 売上額 + 価格ボーナス + 容量ボーナス
- 全量販売可能な市場があれば、そちらを優先

## 初期状態（2期開始時）
- 現金: ¥112
- 材料: 1個, 仕掛品: 2個, 製品: 1個
- ワーカー: 1人, セールスマン: 1人
- 小型機械: 1台
- コンピュータ/保険チップ: 購入済み

## 実装済み機能
- [x] 全社一覧モーダル（右上ボタン）
- [x] aiDoNothing()（パス時は行消費なし）
- [x] startAIBidding()（AI入札処理）
- [x] F/VQ/PQ詳細表示（リセット後も正しく表示）
- [x] PQトップ記録（サイコロ担当追跡）
- [x] 大量販売時の市場容量考慮ロジック
